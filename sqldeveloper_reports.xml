<?xml version="1.0" encoding="UTF-8" ?>
<displays>
<folder>
	<name><![CDATA[Проект DnF]]></name>
	<tooltip><![CDATA[Проект DnF]]></tooltip>
	<description><![CDATA[Скрипты, используемые в проекте DNF]]></description>
		<folder>
		<name><![CDATA[Мониторинг батча]]></name>
		<tooltip><![CDATA[Мониторинг батча]]></tooltip>
		<description><![CDATA[Скрипты для анализа производительности батча]]></description>
			<display id="8f55e099-014c-1000-8001-0a020a0bf708" type="" style="Table" enable="true">
			<name><![CDATA[Долгое выполнение шагов батча]]></name>
			<description><![CDATA[Запрос по долговыполняющимся сегодня шагам батча]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE>horizontal</TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[with EXE_RUN_HEAD as 
(select max(jda_run_id) jda_run_id, max(jda_process_id) jda_process_id
from "STSC"."U_EXE_RUN_HEAD"
where trunc(creation_date) = trunc(sysdate)
and jda_process_id in (8, 10)), 

EXE_RUN_DURATION as
(
select h.jda_process_id, s.step_id, s.proc_name, avg(r.end_date - r.start_date) proc_duration --, avg(round((end_date - start_date)*24*60, 2)) dur 
from "STSC"."U_EXE_RUN_HEAD" h, 
     "STSC"."U_EXE_RUN_INF" r, 
     "STSC"."U_EXE_STEP_DEF" s
where h.jda_process_id in (8, 10) and h.creation_date between add_months(sysdate, -1) and sysdate
and r.jda_run_id = h.jda_run_id
and r.run_qty = 1
and r.step_status_code = 4
and s.jda_process_id = h.jda_process_id
and s.step_id = r.jda_step_id
and s.proc_name not in ('UTILITIES.DUMMY_BATCH_JOB')
group by h.jda_process_id, s.step_id, s.proc_name
)

select h.*, 
       d.proc_name, 
       r.JDA_STEP_ID,
       to_char(to_date(trunc(sysdate)+d.proc_duration), 'HH24:MI:SS') "Должно быть", 
       to_char(to_date(trunc(sysdate)+(r.end_date - r.start_date) ), 'HH24:MI:SS') "Вып. сегодня", 
       to_char(to_date(trunc(sysdate)+(r.end_date - r.start_date - proc_duration)), 'HH24:MI:SS') "Отклонение",
       'Step No:'||r.JDA_STEP_ID||' '||d.proc_name||' long runnig in Lenta '||decode(h.jda_process_id, 10, 'Daily', 8, 'Weekly', ' ')||' Batch' topic,
       'Step No:'||r.JDA_STEP_ID||' '||d.proc_name||' has long execution in today Lenta '||decode(h.jda_process_id, 10, 'Daily', 8, 'Weekly', ' ')||' Batch. '||chr(10)||
       'Today it take about '||round((r.end_date - r.start_date)*24*60, 0) || ' min instead of '||round((d.proc_duration)*24*60, 0)||' as usually. '||chr(10)||
       'Could you please find out cause of this slowdown?' describe,
       r.* 
from  EXE_RUN_HEAD h,
      EXE_RUN_DURATION d,
      "STSC"."U_EXE_RUN_INF" r
where d.jda_process_id = h.jda_process_id
and r.jda_run_id = h.jda_run_id
and d.step_id = r.JDA_STEP_ID
and r.end_date - r.start_date   > d.proc_duration + :P_DERIVATION/24/60
order by "Отклонение" desc, r.JDA_STEP_ID]]></sql>
				<binds>
					<bind id="P_DERIVATION">
						<prompt><![CDATA[Допустимое отклонение в мин]]></prompt>
						<tooltip><![CDATA[P_DERIVATION]]></tooltip>
						<value><![CDATA[10]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="" author="" subject="" keywords="" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																						</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<security enable="false" useopenpassword="false" openpassword="" encryption="EXCLUDE_METADATA">
						<permission enable="false" permissionpassword="" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="true" />
					</security>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="8f670051-014c-1000-8015-0a020a0bf708" type="" style="Table" enable="true">
			<name><![CDATA[Статистика по шагу батча]]></name>
			<description><![CDATA[Вывод времени выполнения конкретного шага за период]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE>horizontal</TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[select decode(h.jda_process_id, 8, 'Weekly', 10, 'Daily', null) batch, 
R.JDA_STEP_ID, S.PROC_NAME, S.STEP_DESC, s.step_type_code, 
round((end_date - start_date)*24*60, 2) dur 
, to_char(start_date, 'DD.MM.YYYY HH24:MI:SS') start_date , to_char(end_date, 'DD.MM.YYYY HH24:MI:SS') end_date,
s.max_exec_dur, r.error_message, r.run_qty, r.jda_run_id -- , r.*, s.*
from "STSC"."U_EXE_RUN_HEAD" h , 
"STSC"."U_EXE_RUN_INF" R, 
"STSC"."U_EXE_STEP_DEF" s
where (:P_PROSESS is null and h.jda_process_id in (8, 10) or :P_PROSESS is not null and h.jda_process_id = :P_PROSESS)
and h.creation_date between add_months(sysdate, -(:P_MONTHCOUNT)) and to_date(sysdate+1)
and r.jda_run_id = h.jda_run_id
/*and r.step_status_code = 4
and r.start_date is not null
and r.end_date is not null*/
and s.jda_process_id = h.jda_process_id
and S.STEP_ID = R.JDA_STEP_ID 
--and round((end_date - start_date)*24*60, 2) > s.max_exec_dur
and S.STEP_ID = nvl(:P_STEP_ID, S.STEP_ID)
and upper(s.PROC_NAME) like '%'||upper(nvl(:P_STEP_NAME, s.PROC_NAME))||'%'
--and step_type_code = 'JDA'
order by r.jda_run_id, jda_step_id]]></sql>
				<binds>
					<bind id="P_PROSESS">
						<prompt><![CDATA[Weekly 8, Daily 10]]></prompt>
						<tooltip><![CDATA[P_PROSESS]]></tooltip>
						<value><![CDATA[8]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="P_MONTHCOUNT">
						<prompt><![CDATA[За сколько месяцев смотрим]]></prompt>
						<tooltip><![CDATA[P_MONTHCOUNT]]></tooltip>
						<value><![CDATA[1]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="P_STEP_ID">
						<prompt><![CDATA[Номер шага, если знаете]]></prompt>
						<tooltip><![CDATA[P_STEP_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="P_STEP_NAME">
						<prompt><![CDATA[Подстрока имени, если знаете]]></prompt>
						<tooltip><![CDATA[P_STEP_NAME]]></tooltip>
						<value><![CDATA[UPD_PROMO_INC]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="" author="" subject="" keywords="" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																						</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<security enable="false" useopenpassword="false" openpassword="" encryption="EXCLUDE_METADATA">
						<permission enable="false" permissionpassword="" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="true" />
					</security>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="8f6b34ec-014c-1000-801e-0a020a0bf708" type="" style="Table" enable="true">
			<name><![CDATA[Время выполнения шагов батча за 1 день]]></name>
			<description><![CDATA[Обзор времени выполнения шагов батча за 1 день]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE>horizontal</TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[with EXE_RUN_HEAD as 
(select max(jda_run_id) jda_run_id, max(jda_process_id) jda_process_id
from "STSC"."U_EXE_RUN_HEAD"
where trunc(creation_date) = trunc(nvl(to_date(:P_DATE, 'DDMMYYYY'), sysdate))
and jda_process_id in (8, 10))

select R.JDA_STEP_ID, S.PROC_NAME, S.STEP_DESC, s.step_type_code, 
round((end_date - start_date)*24*60, 2) dur 
, to_char(start_date, 'DD.MM.YYYY HH24:MI:SS') start_date , to_char(end_date, 'DD.MM.YYYY HH24:MI:SS') end_date,
s.max_exec_dur, r.error_message, r.run_qty, r.jda_run_id -- , r.*, s.*
from EXE_RUN_HEAD H , 
"STSC"."U_EXE_RUN_INF" R, 
"STSC"."U_EXE_STEP_DEF" s
where r.jda_run_id = h.jda_run_id
/*and r.step_status_code = 4
and r.start_date is not null
and r.end_date is not null*/
and s.jda_process_id = h.jda_process_id
and S.STEP_ID = R.JDA_STEP_ID 
--and round((end_date - start_date)*24*60, 2) > s.max_exec_dur
--and S.STEP_ID = nvl(:P_STEP_ID, S.STEP_ID)
--and upper(s.PROC_NAME) like '%'||upper(nvl(:P_STEP_NAME, s.PROC_NAME))||'%'
--and step_type_code = 'JDA'
order by r.jda_run_id, jda_step_id]]></sql>
				<binds>
					<bind id="P_DATE">
						<prompt><![CDATA[P_DATE]]></prompt>
						<value><![CDATA[04052015]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="" author="" subject="" keywords="" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																						</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<security enable="false" useopenpassword="false" openpassword="" encryption="EXCLUDE_METADATA">
						<permission enable="false" permissionpassword="" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="true" />
					</security>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="341d0569-014d-1000-8001-0a020a09a31a" type="" style="Table" enable="true">
			<name><![CDATA[Статистика по SRE]]></name>
			<description><![CDATA[Статистика по шагам с типом JDA - сколько данных и за сколько обработали]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE>horizontal</TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[select e.value done, e.name_res_key par_name, 
       round((s.end_date-s.start_date)*24*60, 2 ) dur, 
       nvl(s.batch_step_name, s.batch_name) step_name, 
       s.* 
from "WWFMGR"."SRE_JOB_SUMMARY" s 
left join "WWFMGR"."SRE_JOB_SUMMARY_EXT" e 
          on e.job_id = s.job_id
where s.start_date >= add_months(sysdate, -nvl(:P_MONTH_COUNT, 2)) 
and s.user_name = 'BatchUser'
and upper(COALESCE(s.batch_step_name, s.batch_name, s.service_name)) like upper('%'||nvl(:P_STEP_NAME, '')||'%')
and to_char(s.start_date, 'HH24') < nvl(:P_HOURS, '19')
order by s.job_id desc, e.name_res_key]]></sql>
				<binds>
					<bind id="P_MONTH_COUNT">
						<prompt><![CDATA[За сколько месяцев]]></prompt>
						<tooltip><![CDATA[P_MONTH_COUNT]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="P_STEP_NAME">
						<prompt><![CDATA[Имя шага]]></prompt>
						<tooltip><![CDATA[P_STEP_NAME]]></tooltip>
						<value><![CDATA[Demand.Reconcile]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="P_HOURS">
						<prompt><![CDATA[Отсекаем вечерний батч]]></prompt>
						<tooltip><![CDATA[P_HOURS]]></tooltip>
						<value><![CDATA[1]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="" author="" subject="" keywords="" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																								</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<security enable="false" useopenpassword="false" openpassword="" encryption="EXCLUDE_METADATA">
						<permission enable="false" permissionpassword="" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="true" />
					</security>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="43a21ee1-0151-1000-8001-0a020a02fd76" type="" style="Table" enable="true">
			<name><![CDATA[Сравнение сегодняшнего батча с предыдущим запуском]]></name>
			<description><![CDATA[Сравнение сегодняшнего батча с предыдущим запуском]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE>horizontal</TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[with runs as 
  (select NVL(:CUR_RUN, sum(today_run_id)) today_run_id, NVL(:PREV_RUN, sum(prev_run_id)) prev_run_id 
  from 
    (select /*+ index_desc(h U_EXE_RUN_HEAD_PK)*/ decode(rownum, 1, jda_run_id, 0) today_run_id, decode(rownum, 2, jda_run_id, 0) prev_run_id
    from "STSC"."U_EXE_RUN_HEAD" h
    where h.jda_process_id = nvl(:p_jda_process_id, 10)
    and rownum <=2)
  )

select nvl(:p_jda_process_id, 10) as proc_id, s.step_id, s.proc_name, s.step_type_code,
h.prev_run_id, prev_r.start_date prev_start_date, prev_r.end_date prev_end_date, round((prev_r.end_date - prev_r.start_date)*24*60, 2) prev_dur,
h.today_run_id, today_r.start_date today_start_date, today_r.end_date today_end_date, round((today_r.end_date - today_r.start_date)*24*60, 2) today_dur,
round(( NVL((prev_r.end_date - prev_r.start_date),0) - (today_r.end_date - today_r.start_date) )*24*60, 2) diff_prev_today,
round( sum( NVL((prev_r.end_date - prev_r.start_date),0) - (today_r.end_date - today_r.start_date))  over()  *24*60, 2) total_diff
from runs h 
join "STSC"."U_EXE_RUN_INF" today_r on h.today_run_id = today_r.jda_run_id
join "STSC"."U_EXE_STEP_DEF" s on s.jda_process_id = nvl(:p_jda_process_id, 10) and s.step_id = today_r.jda_step_id 
left join "STSC"."U_EXE_RUN_INF" prev_r on h.prev_run_id = prev_r.jda_run_id and today_r.jda_step_id = prev_r.jda_step_id 
where (nvl(:p_monitor, 0) = 0 and s.proc_name not like '%monitor%')
or nvl(:p_monitor, 0) = 1
order by diff_prev_today]]></sql>
				<binds>
					<bind id="CUR_RUN">
						<prompt><![CDATA[Текущий запуск]]></prompt>
						<tooltip><![CDATA[CUR_RUN]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="PREV_RUN">
						<prompt><![CDATA[Предыдущий запуск]]></prompt>
						<tooltip><![CDATA[PREV_RUN]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="p_jda_process_id">
						<prompt><![CDATA[Weekly 8, Daily 10]]></prompt>
						<tooltip><![CDATA[p_jda_process_id]]></tooltip>
						<value><![CDATA[10]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="p_monitor">
						<prompt><![CDATA[Учитывать мониторы]]></prompt>
						<tooltip><![CDATA[p_monitor]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="" author="" subject="" keywords="" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																												</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<security enable="false" useopenpassword="false" openpassword="" encryption="EXCLUDE_METADATA">
						<permission enable="false" permissionpassword="" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="true" />
					</security>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
			<display id="" type="" style="Table" enable="true">
				<name><![CDATA[step]]></name>
				<description><![CDATA[]]></description>
				<tooltip><![CDATA[]]></tooltip>
				<drillclass><![CDATA[]]></drillclass>
				<CustomValues>
					<TYPE>horizontal</TYPE>
				</CustomValues>
				<query>
					<sql><![CDATA[select decode(h.jda_process_id, 8, 'Weekly', 10, 'Daily', null) batch, 
R.JDA_STEP_ID, S.PROC_NAME, S.STEP_DESC, s.step_type_code, 
round((end_date - start_date)*24*60, 2) dur 
, to_char(start_date, 'DD.MM.YYYY HH24:MI:SS') start_date , to_char(end_date, 'DD.MM.YYYY HH24:MI:SS') end_date,
s.max_exec_dur, r.error_message, r.run_qty, r.jda_run_id -- , r.*, s.*
from "STSC"."U_EXE_RUN_HEAD" h , 
"STSC"."U_EXE_RUN_INF" R, 
"STSC"."U_EXE_STEP_DEF" s
where (:PROC_ID is null and h.jda_process_id in (8, 10) or :PROC_ID is not null and h.jda_process_id = :PROC_ID)
and h.creation_date between add_months(sysdate, -2) and to_date(sysdate+1)
and r.jda_run_id = h.jda_run_id
and s.jda_process_id = h.jda_process_id
and S.STEP_ID = R.JDA_STEP_ID 
and S.STEP_ID = :STEP_ID
order by r.jda_run_id desc, jda_step_id desc]]></sql>
					<binds>
						<bind id="PROC_ID">
							<prompt><![CDATA[PROC_ID]]></prompt>
							<tooltip><![CDATA[PROC_ID]]></tooltip>
							<value><![CDATA[NULL_VALUE]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
						<bind id="STEP_ID">
							<prompt><![CDATA[STEP_ID]]></prompt>
							<tooltip><![CDATA[STEP_ID]]></tooltip>
							<value><![CDATA[NULL_VALUE]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
					</binds>
				</query>
					<pdf version="VERSION_1_7" compression="CONTENT">
						<docproperty title="null" author="null" subject="null" keywords="null" />
						<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
						<column>
							<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
							<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
							<blob blob="NONE" zip="false" />
						</column>
						<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
						<header enable="false" generatedate="false">
							<data>
							
							
							
							
							
							
							
							null																																																								</data>
						</header>
						<footer enable="false" generatedate="false">
							<data value="null" />
						</footer>
						<security enable="false" useopenpassword="false" openpassword="null" encryption="EXCLUDE_METADATA">
							<permission enable="false" permissionpassword="null" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="false" />
						</security>
						<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
					</pdf>
			</display>
			<display id="" type="" style="Table" enable="true">
				<name><![CDATA[ash]]></name>
				<description><![CDATA[]]></description>
				<tooltip><![CDATA[]]></tooltip>
				<drillclass><![CDATA[]]></drillclass>
				<CustomValues>
					<TYPE>horizontal</TYPE>
				</CustomValues>
				<query>
					<sql><![CDATA[select distinct module, v.sql_id, SQL_PLAN_HASH_VALUE, st_dt,ed_dt, execs, round(gb,2) as gb, round(av_sec,2) as av_sec, secs, smpl, round(av_smpl,2) as av_smpl,  trim(DBMS_LOB.SUBSTR (t.sql_text,400)) as txt 
from 
(
  select module, sql_id, SQL_PLAN_HASH_VALUE, st_dt,ed_dt, execs, gb, av_sec, secs, smpl, av_smpl
  from (
    select max(module) KEEP (DENSE_RANK FIRST ORDER BY execs desc) module, sql_id, min(st_dt) st_dt,max(ed_dt) ed_dt, SQL_PLAN_HASH_VALUE, sum(execs) execs, 
    sum(gb) gb, avg(av_sec) av_sec, sum(secs) secs, sum(smpl) smpl, avg(av_smpl) av_smpl
    from (
      select module, sql_id, min(sql_exec_start) as st_dt, max(sql_exec_start) ed_dt, 
            SQL_PLAN_HASH_VALUE, sum(execs) execs, sum(gb) as gb, avg(secs) as av_sec, sum(secs) secs, sum(smpl) smpl, avg(smpl) av_smpl
      from
      (
        select /*+ parallel(8) */ h.sql_exec_start, h.module, h.sql_id, h.SQL_PLAN_HASH_VALUE, count(distinct sql_exec_id) as execs,  SUM (delta_read_io_bytes)/1024/1024/1024 as gb, 
        to_char(max(sample_time),'SSSSS') - to_char(sql_exec_start,'SSSSS')  as secs, count(*) as smpl
         FROM   dba_hist_active_sess_history h
        where 
        h.sample_time between to_date(:TODAY_START_DATE, 'dd.mm.yy hh24:mi:ss') and to_date(:TODAY_END_DATE, 'dd.mm.yy hh24:mi:ss')
        and h.sql_id is not null
        group by h.sql_id, h.SQL_PLAN_HASH_VALUE, h.module, h.sql_exec_start, h.sql_exec_id
      ) vvv
      group by sql_id, SQL_PLAN_HASH_VALUE, module
    ) vv
    group by sql_id, SQL_PLAN_HASH_VALUE
    order by smpl desc nulls last
  )
  where rownum <= 100
) v
left join dba_hist_sqltext t on t.sql_id = v.sql_id
order by secs desc nulls last]]></sql>
					<binds>
						<bind id="TODAY_START_DATE">
							<prompt><![CDATA[TODAY_START_DATE]]></prompt>
							<tooltip><![CDATA[TODAY_START_DATE]]></tooltip>
							<value><![CDATA[NULL_VALUE]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
						<bind id="TODAY_END_DATE">
							<prompt><![CDATA[TODAY_END_DATE]]></prompt>
							<tooltip><![CDATA[TODAY_END_DATE]]></tooltip>
							<value><![CDATA[NULL_VALUE]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
					</binds>
				</query>
					<pdf version="VERSION_1_7" compression="CONTENT">
						<docproperty title="null" author="null" subject="null" keywords="null" />
						<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
						<column>
							<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
							<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
							<blob blob="NONE" zip="false" />
						</column>
						<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
						<header enable="false" generatedate="false">
							<data>
							
							
							
							
							null																																			</data>
						</header>
						<footer enable="false" generatedate="false">
							<data value="null" />
						</footer>
						<security enable="false" useopenpassword="false" openpassword="null" encryption="EXCLUDE_METADATA">
							<permission enable="false" permissionpassword="null" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="false" />
						</security>
						<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
					</pdf>
			</display>
			<display id="" type="" style="Table" enable="true">
				<name><![CDATA[ash_prev]]></name>
				<description><![CDATA[]]></description>
				<tooltip><![CDATA[]]></tooltip>
				<drillclass><![CDATA[]]></drillclass>
				<CustomValues>
					<TYPE>horizontal</TYPE>
				</CustomValues>
				<query>
					<sql><![CDATA[select distinct module, v.sql_id, SQL_PLAN_HASH_VALUE, st_dt,ed_dt, execs, round(gb,2) as gb, round(av_sec,2) as av_sec, secs, smpl, round(av_smpl,2) as av_smpl,  trim(DBMS_LOB.SUBSTR (t.sql_text,400)) as txt 
from 
(
  select module, sql_id, SQL_PLAN_HASH_VALUE, st_dt,ed_dt, execs, gb, av_sec, secs, smpl, av_smpl
  from (
    select max(module) KEEP (DENSE_RANK FIRST ORDER BY execs desc) module, sql_id, min(st_dt) st_dt,max(ed_dt) ed_dt, SQL_PLAN_HASH_VALUE, sum(execs) execs, 
    sum(gb) gb, avg(av_sec) av_sec, sum(secs) secs, sum(smpl) smpl, avg(av_smpl) av_smpl
    from (
      select module, sql_id, min(sql_exec_start) as st_dt, max(sql_exec_start) ed_dt, 
            SQL_PLAN_HASH_VALUE, sum(execs) execs, sum(gb) as gb, avg(secs) as av_sec, sum(secs) secs, sum(smpl) smpl, avg(smpl) av_smpl
      from
      (
        select /*+ parallel(8) */ h.sql_exec_start, h.module, h.sql_id, h.SQL_PLAN_HASH_VALUE, count(distinct sql_exec_id) as execs,  SUM (delta_read_io_bytes)/1024/1024/1024 as gb, 
        to_char(max(sample_time),'SSSSS') - to_char(sql_exec_start,'SSSSS')  as secs, count(*) as smpl
         FROM   dba_hist_active_sess_history h
        where 
        h.sample_time between to_date(:PREV_START_DATE, 'dd.mm.yy hh24:mi:ss') and to_date(:PREV_END_DATE, 'dd.mm.yy hh24:mi:ss')
        and h.sql_id is not null
        group by h.sql_id, h.SQL_PLAN_HASH_VALUE, h.module, h.sql_exec_start, h.sql_exec_id
      ) vvv
      group by sql_id, SQL_PLAN_HASH_VALUE, module
    ) vv
    group by sql_id, SQL_PLAN_HASH_VALUE
    order by smpl desc nulls last
  )
  where rownum <= 100
) v
left join dba_hist_sqltext t on t.sql_id = v.sql_id
order by secs desc nulls last]]></sql>
					<binds>
						<bind id="PREV_START_DATE">
							<prompt><![CDATA[PREV_START_DATE]]></prompt>
							<tooltip><![CDATA[PREV_START_DATE]]></tooltip>
							<value><![CDATA[NULL_VALUE]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
						<bind id="PREV_END_DATE">
							<prompt><![CDATA[PREV_END_DATE]]></prompt>
							<tooltip><![CDATA[PREV_END_DATE]]></tooltip>
							<value><![CDATA[NULL_VALUE]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
					</binds>
				</query>
					<pdf version="VERSION_1_7" compression="CONTENT">
						<docproperty title="null" author="null" subject="null" keywords="null" />
						<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
						<column>
							<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
							<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
							<blob blob="NONE" zip="false" />
						</column>
						<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
						<header enable="false" generatedate="false">
							<data>
							
							null														</data>
						</header>
						<footer enable="false" generatedate="false">
							<data value="null" />
						</footer>
						<security enable="false" useopenpassword="false" openpassword="null" encryption="EXCLUDE_METADATA">
							<permission enable="false" permissionpassword="null" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="false" />
						</security>
						<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
					</pdf>
			</display>
		</display>
	</folder>
	<folder>
		<name><![CDATA[Настройка батча]]></name>
		<tooltip><![CDATA[Настройка батча]]></tooltip>
		<description><![CDATA[Настройка батча]]></description>
			<display id="97fa7daa-014c-1000-8001-0a02460f099c" type="" style="Table" enable="true">
			<name><![CDATA[Последовательность шагов батча]]></name>
			<description><![CDATA[Последовательность шагов батча]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE>horizontal</TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[select * from "STSC"."U_EXE_STEP_PREREQ"
where jda_process_id = :P_PROCESS_ID
order by prereq_step_id, step_id]]></sql>
				<binds>
					<bind id="P_PROCESS_ID">
						<prompt><![CDATA[P_PROCESS_ID]]></prompt>
						<tooltip><![CDATA[P_PROCESS_ID]]></tooltip>
						<value><![CDATA[10]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="" author="" subject="" keywords="" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<security enable="false" useopenpassword="false" openpassword="" encryption="EXCLUDE_METADATA">
						<permission enable="false" permissionpassword="" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="true" />
					</security>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
	</folder>
	<folder>
		<name><![CDATA[ash]]></name>
		<tooltip><![CDATA[ash]]></tooltip>
		<description><![CDATA[ ]]></description>
			<display id="74c746aa-0157-1000-8029-0a02322027a3" type="" style="Table" enable="true">
			<name><![CDATA[sql_id plans]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[null]]></drillclass>
			<CustomValues>
				<TYPE>horizontal</TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[select :sql_id SQL_ID, PLAN_HASH_VALUE, min(begin_interval_time) as stdt, max(begin_interval_time) enddt, sum(EXECUTIONS_DELTA) as execs, 
round(avg(drid),2) drid, round(avg(buf_red),2) buf_red, round(avg(phys_gb),2) phys_gb, round(avg(rws),2) rws, 
round(avg(ELAPSED_TIME_DELTA),2) avg_ela_tm, round(max(ELAPSED_TIME_DELTA),2) max_ela_tm from (
  select s.snap_id, s.module, t.begin_interval_time, sql_id, PLAN_HASH_VALUE, nvl(nullif(EXECUTIONS_DELTA,0),1) EXECUTIONS_DELTA, round(DISK_READS_DELTA/nvl(nullif(EXECUTIONS_DELTA,0),1)) as drid, round(BUFFER_GETS_DELTA/nvl(nullif(EXECUTIONS_DELTA,0),1)) as buf_red, round(PHYSICAL_READ_BYTES_DELTA/nvl(nullif(EXECUTIONS_DELTA,0),1)/1024/1024/1024) as phys_gb, 
  --round(case when END_OF_FETCH_COUNT_TOTAL = 1 then ROWS_PROCESSED_DELTA/nvl(nullif(EXECUTIONS_DELTA,0) ,1) end) as rws,
  round(nullif( ROWS_PROCESSED_DELTA,0) /nvl(nullif(EXECUTIONS_DELTA,0) ,1)) as rws,
  round(s.ELAPSED_TIME_DELTA/nvl(nullif(EXECUTIONS_DELTA,0),1)/1000/1000,2) as ELAPSED_TIME_DELTA, nvl(nullif(EXECUTIONS_DELTA,0),1),OPTIMIZER_COST,IOWAIT_DELTA,
  round(IO_OFFLOAD_RETURN_BYTES_DELTA/1024/1024/1024,2) as off_gb  , round(IO_OFFLOAD_ELIG_BYTES_DELTA/1024/1024/1024,2) as eligb_gb
  from DBA_HIST_SQLSTAT s
  join DBA_HIST_SNAPSHOT t on t.snap_id = s.snap_id and t.INSTANCE_NUMBER = s.INSTANCE_NUMBER
  where 1=1
  and sql_id = :sql_id
)
group by PLAN_HASH_VALUE
order by enddt desc]]></sql>
				<binds>
					<bind id="sql_id">
						<prompt><![CDATA[sql_id]]></prompt>
						<tooltip><![CDATA[sql_id]]></tooltip>
						<value><![CDATA[8p464y4pbrsr2]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="" author="" subject="" keywords="" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
						
						
						
						
						
						
						
				
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																										</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<security enable="false" useopenpassword="false" openpassword="" encryption="EXCLUDE_METADATA">
						<permission enable="false" permissionpassword="" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="true" />
					</security>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
			<display id="null" type="" style="Table" enable="true">
				<name><![CDATA[plan]]></name>
				<description><![CDATA[]]></description>
				<tooltip><![CDATA[]]></tooltip>
				<drillclass><![CDATA[null]]></drillclass>
				<CustomValues>
					<TYPE>horizontal</TYPE>
				</CustomValues>
				<query>
					<sql><![CDATA[select * from table(DBMS_XPLAN.DISPLAY_AWR(:SQL_ID, :PLAN_HASH_VALUE, null, 'basic +outline +peeked_binds') )]]></sql>
				</query>
					<pdf version="VERSION_1_7" compression="CONTENT">
						<docproperty title="null" author="null" subject="null" keywords="null" />
						<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
						<column>
							<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
							<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
							<blob blob="NONE" zip="false" />
						</column>
						<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
						<header enable="false" generatedate="false">
							<data>
							
							
							
							
							
							
							
							null																																																								</data>
						</header>
						<footer enable="false" generatedate="false">
							<data value="null" />
						</footer>
						<security enable="false" useopenpassword="false" openpassword="null" encryption="EXCLUDE_METADATA">
							<permission enable="false" permissionpassword="null" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="false" />
						</security>
						<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
					</pdf>
			</display>
<item  reload="false"  reloadparent="false" removeFromParent="false" className="oracle.dbtools.raptor.report.addin.DrillReportAction" classArgs="74e95624-0157-1000-8041-0a02322027a3" toolbar="false" ><title>ash</title></item>		</display>
		<display id="74cae989-0157-1000-802d-0a02322027a3" type="" style="Table" enable="true">
			<name><![CDATA[query ash now]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE>horizontal</TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[select  h.client_id, h.module, sql_exec_start, h.sql_id, h.SQL_PLAN_HASH_VALUE, 
to_char(max(sample_time),'SSSSS') - to_char(sql_exec_start,'SSSSS')  as secs, 
count(*) cnt, round(SUM (delta_read_io_bytes)/1024/1024/1024,3) as gb, sum(h.delta_read_io_requests)/1000 as kreg,
max(s.SQL_TEXT) as sql_text
FROM   gv$active_session_history h
left join v$sql s on s.sql_id = h.sql_id
where 1=1
and h.sql_id = NVL(:sql_id, h.sql_id)
and h.client_id = NVL(:client_id, h.client_id)
group by h.sql_id, h.SQL_PLAN_HASH_VALUE, h.sql_exec_start, h.module, h.client_id
order by sql_exec_start desc nulls last]]></sql>
				<binds>
					<bind id="sql_id">
						<prompt><![CDATA[sql_id]]></prompt>
						<tooltip><![CDATA[sql_id]]></tooltip>
						<value><![CDATA[8p464y4pbrsr2]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="client_id">
						<prompt><![CDATA[client_id]]></prompt>
						<tooltip><![CDATA[client_id]]></tooltip>
						<value><![CDATA[DEMAKIN]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="" author="" subject="" keywords="" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
						
						
						
						
						
						
						
				
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																										</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<security enable="false" useopenpassword="false" openpassword="" encryption="EXCLUDE_METADATA">
						<permission enable="false" permissionpassword="" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="true" />
					</security>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
			<display id="" type="" style="Table" enable="true">
				<name><![CDATA[plans]]></name>
				<description><![CDATA[]]></description>
				<tooltip><![CDATA[]]></tooltip>
				<drillclass><![CDATA[]]></drillclass>
				<CustomValues>
					<TYPE>horizontal</TYPE>
				</CustomValues>
				<query>
					<sql><![CDATA[select PLAN_HASH_VALUE, min(begin_interval_time) as stdt, max(begin_interval_time) enddt, sum(EXECUTIONS_DELTA) as execs, 
round(avg(drid),2) drid, round(avg(buf_red),2) buf_red, round(avg(phys_gb),2) phys_gb, round(avg(rws),2) rws, 
round(avg(ELAPSED_TIME_DELTA),2) avg_ela_tm, round(max(ELAPSED_TIME_DELTA),2) max_ela_tm from (
  select s.snap_id, s.module, t.begin_interval_time, sql_id, PLAN_HASH_VALUE, nvl(nullif(EXECUTIONS_DELTA,0),1) EXECUTIONS_DELTA, round(DISK_READS_DELTA/nvl(nullif(EXECUTIONS_DELTA,0),1)) as drid, round(BUFFER_GETS_DELTA/nvl(nullif(EXECUTIONS_DELTA,0),1)) as buf_red, round(PHYSICAL_READ_BYTES_DELTA/nvl(nullif(EXECUTIONS_DELTA,0),1)/1024/1024/1024) as phys_gb, 
  round(ROWS_PROCESSED_DELTA/nvl(nullif(EXECUTIONS_DELTA,0),1)) as rws, round(s.ELAPSED_TIME_DELTA/nvl(nullif(EXECUTIONS_DELTA,0),1)/1000/1000,2) as ELAPSED_TIME_DELTA, nvl(nullif(EXECUTIONS_DELTA,0),1),OPTIMIZER_COST,IOWAIT_DELTA,
  round(IO_OFFLOAD_RETURN_BYTES_DELTA/1024/1024/1024,2) as off_gb  , round(IO_OFFLOAD_ELIG_BYTES_DELTA/1024/1024/1024,2) as eligb_gb
  from DBA_HIST_SQLSTAT s
  join DBA_HIST_SNAPSHOT t on t.snap_id = s.snap_id and t.INSTANCE_NUMBER = s.INSTANCE_NUMBER
  where 1=1
  and sql_id = :SQL_ID
)
group by PLAN_HASH_VALUE
order by enddt desc]]></sql>
					<binds>
						<bind id="SQL_ID">
							<prompt><![CDATA[SQL_ID]]></prompt>
							<tooltip><![CDATA[SQL_ID]]></tooltip>
							<value><![CDATA[NULL_VALUE]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
					</binds>
				</query>
					<pdf version="VERSION_1_7" compression="CONTENT">
						<docproperty title="null" author="null" subject="null" keywords="null" />
						<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
						<column>
							<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
							<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
							<blob blob="NONE" zip="false" />
						</column>
						<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
						<header enable="false" generatedate="false">
							<data>
							
							
							
							null																												</data>
						</header>
						<footer enable="false" generatedate="false">
							<data value="null" />
						</footer>
						<security enable="false" useopenpassword="false" openpassword="null" encryption="EXCLUDE_METADATA">
							<permission enable="false" permissionpassword="null" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="false" />
						</security>
						<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
					</pdf>
			</display>
		</display>
		<display id="74e95624-0157-1000-8041-0a02322027a3" type="" style="Table" enable="true">
			<name><![CDATA[ash]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[null]]></drillclass>
			<CustomValues>
				<TYPE>horizontal</TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[select distinct module, v.sql_id, SQL_PLAN_HASH_VALUE, st_dt,ed_dt, execs, round(gb,2) as gb, round(av_sec,2) as av_sec, secs, smpl, round(av_smpl,2) as av_smpl, 
trim(DBMS_LOB.SUBSTR (t.sql_text,400)) as txt 
from 
(
  select module, sql_id, SQL_PLAN_HASH_VALUE, st_dt,ed_dt, execs, gb, av_sec, secs, smpl, av_smpl
  from (
    select max(module) KEEP (DENSE_RANK FIRST ORDER BY execs desc) module, sql_id, min(st_dt) st_dt,max(ed_dt) ed_dt, SQL_PLAN_HASH_VALUE, sum(execs) execs, 
    sum(gb) gb, avg(av_sec) av_sec, sum(secs) secs, sum(smpl) smpl, avg(av_smpl) av_smpl
    from (
      select module, sql_id, min(sql_exec_start) as st_dt, max(msmpl_tm) ed_dt, 
            SQL_PLAN_HASH_VALUE, sum(execs) execs, sum(gb) as gb, avg(secs) as av_sec, sum(secs) secs, sum(smpl) smpl, avg(smpl) av_smpl
      from
      (
        select /*+ parallel(8) */ h.sql_exec_start, h.module, h.sql_id, h.SQL_PLAN_HASH_VALUE, count(distinct sql_exec_id) as execs,  SUM (delta_read_io_bytes)/1024/1024/1024 as gb, 
        to_char(max(sample_time),'SSSSS') - to_char(sql_exec_start,'SSSSS')  as secs, count(*) as smpl, max(h.sample_time) as msmpl_tm
         FROM   dba_hist_active_sess_history h
        where 
        h.sample_time between to_date(:f, 'dd.mm.yyyy hh24:mi:ss') and to_date(:t, 'dd.mm.yyyy hh24:mi:ss')
        and h.sql_id is not null
        and ( h.module = :m or :m is null )
        and ( h.client_id = :c or :c is null )
        and ( h.sql_id = :sql_id or :sql_id is null )
        and ( h.SQL_PLAN_HASH_VALUE = :hsh or :hsh is null )
        group by h.sql_id, h.SQL_PLAN_HASH_VALUE, h.module, h.sql_exec_start, h.sql_exec_id
      ) vvv
      group by sql_id, SQL_PLAN_HASH_VALUE, module
    ) vv
    group by sql_id, SQL_PLAN_HASH_VALUE
    order by smpl desc nulls last
  )
  where rownum <= 50
) v
left join dba_hist_sqltext t on t.sql_id = v.sql_id
order by case when nvl(:smpl,1)=1 then smpl else secs end desc nulls last]]></sql>
				<binds>
					<bind id="f">
						<prompt><![CDATA[f]]></prompt>
						<tooltip><![CDATA[f]]></tooltip>
						<value><![CDATA[24.10.2016]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="t">
						<prompt><![CDATA[t]]></prompt>
						<tooltip><![CDATA[t]]></tooltip>
						<value><![CDATA[31.10.2016]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="m">
						<prompt><![CDATA[module]]></prompt>
						<tooltip><![CDATA[m]]></tooltip>
						<value><![CDATA[ZRE_MATRIX]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="c">
						<prompt><![CDATA[client]]></prompt>
						<tooltip><![CDATA[c]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="sql_id">
						<prompt><![CDATA[sql_id]]></prompt>
						<tooltip><![CDATA[sql_id]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="hsh">
						<prompt><![CDATA[hsh]]></prompt>
						<tooltip><![CDATA[hsh]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="smpl">
						<prompt><![CDATA[smpl]]></prompt>
						<tooltip><![CDATA[smpl]]></tooltip>
						<value><![CDATA[0]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
						
						
						
						
						
						
						
				
				null																																																								</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<security enable="false" useopenpassword="false" openpassword="null" encryption="EXCLUDE_METADATA">
						<permission enable="false" permissionpassword="null" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="false" />
					</security>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
			<display id="null" type="" style="Table" enable="true">
				<name><![CDATA[sql_id plans]]></name>
				<description><![CDATA[]]></description>
				<tooltip><![CDATA[]]></tooltip>
				<drillclass><![CDATA[null]]></drillclass>
				<CustomValues>
					<TYPE>horizontal</TYPE>
				</CustomValues>
				<query>
					<sql><![CDATA[select PLAN_HASH_VALUE, min(begin_interval_time) as stdt, max(begin_interval_time) enddt, sum(EXECUTIONS_DELTA) as execs, 
round(avg(drid),2) drid, round(avg(buf_red),2) buf_red, round(avg(phys_gb),2) phys_gb, round(avg(rws),2) rws, 
round(avg(ELAPSED_TIME_DELTA),2) avg_ela_tm, round(max(ELAPSED_TIME_DELTA),2) max_ela_tm from (
  select s.snap_id, s.module, t.begin_interval_time, sql_id, PLAN_HASH_VALUE, nvl(nullif(EXECUTIONS_DELTA,0),1) EXECUTIONS_DELTA, round(DISK_READS_DELTA/nvl(nullif(EXECUTIONS_DELTA,0),1)) as drid, round(BUFFER_GETS_DELTA/nvl(nullif(EXECUTIONS_DELTA,0),1)) as buf_red, round(PHYSICAL_READ_BYTES_DELTA/nvl(nullif(EXECUTIONS_DELTA,0),1)/1024/1024/1024) as phys_gb, 
  --round(case when END_OF_FETCH_COUNT_TOTAL = 1 then ROWS_PROCESSED_DELTA/nvl(nullif(EXECUTIONS_DELTA,0) ,1) end) as rws, 
  round(nullif(ROWS_PROCESSED_DELTA,0)/nvl(nullif(EXECUTIONS_DELTA,0) ,1)) as rws,
  round(s.ELAPSED_TIME_DELTA/nvl(nullif(EXECUTIONS_DELTA,0),1)/1000/1000,2) as ELAPSED_TIME_DELTA, nvl(nullif(EXECUTIONS_DELTA,0),1),OPTIMIZER_COST,IOWAIT_DELTA,
  round(IO_OFFLOAD_RETURN_BYTES_DELTA/1024/1024/1024,2) as off_gb  , round(IO_OFFLOAD_ELIG_BYTES_DELTA/1024/1024/1024,2) as eligb_gb
  from DBA_HIST_SQLSTAT s
  join DBA_HIST_SNAPSHOT t on t.snap_id = s.snap_id and t.INSTANCE_NUMBER = s.INSTANCE_NUMBER
  where 1=1
  and sql_id = :SQL_ID
)
group by PLAN_HASH_VALUE
order by enddt desc]]></sql>
					<binds>
						<bind id="SQL_ID">
							<prompt><![CDATA[SQL_ID]]></prompt>
							<tooltip><![CDATA[SQL_ID]]></tooltip>
							<value><![CDATA[NULL_VALUE]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
					</binds>
				</query>
					<pdf version="VERSION_1_7" compression="CONTENT">
						<docproperty title="null" author="null" subject="null" keywords="null" />
						<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
						<column>
							<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
							<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
							<blob blob="NONE" zip="false" />
						</column>
						<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
						<header enable="false" generatedate="false">
							<data>
							
							
							
							
							
							
							
							null																																																								</data>
						</header>
						<footer enable="false" generatedate="false">
							<data value="null" />
						</footer>
						<security enable="false" useopenpassword="false" openpassword="null" encryption="EXCLUDE_METADATA">
							<permission enable="false" permissionpassword="null" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="false" />
						</security>
						<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
					</pdf>
			</display>
			<display id="null" type="" style="Table" enable="true">
				<name><![CDATA[ash now]]></name>
				<description><![CDATA[]]></description>
				<tooltip><![CDATA[]]></tooltip>
				<drillclass><![CDATA[null]]></drillclass>
				<CustomValues>
					<TYPE>horizontal</TYPE>
				</CustomValues>
				<query>
					<sql><![CDATA[select  h.client_id, h.module, sql_exec_start, h.sql_id, h.SQL_PLAN_HASH_VALUE, 
to_char(max(sample_time),'SSSSS') - to_char(sql_exec_start,'SSSSS')  as secs,
count(*) cnt, SUM (delta_read_io_bytes)/1024/1024/1024 as gb, sum(h.delta_read_io_requests)/1000 as kreg
FROM   gv$active_session_history h
where 1=1
and h.sql_id = :SQL_ID /*AND ( h.SQL_PLAN_HASH_VALUE = :SQL_PLAN_HASH_VALUE OR NVL(:SQL_PLAN_HASH_VALUE,0) = 0 )*/
group by h.sql_id, h.SQL_PLAN_HASH_VALUE, sql_exec_start, module, h.client_id
order by sql_exec_start desc nulls last]]></sql>
					<binds>
						<bind id="SQL_ID">
							<prompt><![CDATA[SQL_ID]]></prompt>
							<tooltip><![CDATA[SQL_ID]]></tooltip>
							<value><![CDATA[NULL_VALUE]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
					</binds>
				</query>
					<pdf version="VERSION_1_7" compression="CONTENT">
						<docproperty title="null" author="null" subject="null" keywords="null" />
						<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
						<column>
							<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
							<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
							<blob blob="NONE" zip="false" />
						</column>
						<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
						<header enable="false" generatedate="false">
							<data>
							
							
							
							
							
							
							
							null																																																								</data>
						</header>
						<footer enable="false" generatedate="false">
							<data value="null" />
						</footer>
						<security enable="false" useopenpassword="false" openpassword="null" encryption="EXCLUDE_METADATA">
							<permission enable="false" permissionpassword="null" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="false" />
						</security>
						<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
					</pdf>
			</display>
			<display id="null" type="" style="Table" enable="true">
				<name><![CDATA[plan]]></name>
				<description><![CDATA[]]></description>
				<tooltip><![CDATA[]]></tooltip>
				<drillclass><![CDATA[null]]></drillclass>
				<CustomValues>
					<TYPE>horizontal</TYPE>
				</CustomValues>
				<query>
					<sql><![CDATA[select * from table(DBMS_XPLAN.DISPLAY_AWR(:SQL_ID, :SQL_PLAN_HASH_VALUE, null, 'basic +outline +peeked_binds') )]]></sql>
					<binds>
						<bind id="SQL_ID">
							<prompt><![CDATA[SQL_ID]]></prompt>
							<tooltip><![CDATA[SQL_ID]]></tooltip>
							<value><![CDATA[NULL_VALUE]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
						<bind id="SQL_PLAN_HASH_VALUE">
							<prompt><![CDATA[SQL_PLAN_HASH_VALUE]]></prompt>
							<tooltip><![CDATA[SQL_PLAN_HASH_VALUE]]></tooltip>
							<value><![CDATA[NULL_VALUE]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
					</binds>
				</query>
					<pdf version="VERSION_1_7" compression="CONTENT">
						<docproperty title="null" author="null" subject="null" keywords="null" />
						<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
						<column>
							<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
							<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
							<blob blob="NONE" zip="false" />
						</column>
						<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
						<header enable="false" generatedate="false">
							<data>
							
							
							
							
							
							
							
							null																																																								</data>
						</header>
						<footer enable="false" generatedate="false">
							<data value="null" />
						</footer>
						<security enable="false" useopenpassword="false" openpassword="null" encryption="EXCLUDE_METADATA">
							<permission enable="false" permissionpassword="null" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="false" />
						</security>
						<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
					</pdf>
			</display>
			<display id="null" type="" style="Table" enable="true">
				<name><![CDATA[binds]]></name>
				<description><![CDATA[]]></description>
				<tooltip><![CDATA[]]></tooltip>
				<drillclass><![CDATA[null]]></drillclass>
				<CustomValues>
					<TYPE>horizontal</TYPE>
				</CustomValues>
				<query>
					<sql><![CDATA[select last_captured, DATATYPE_STRING, NAME, VALUE_STRING from dba_hist_sqlbind where sql_id = :SQL_ID 
and last_captured+1 > :ED_DT
order by snap_id desc, position asc]]></sql>
					<binds>
						<bind id="SQL_ID">
							<prompt><![CDATA[SQL_ID]]></prompt>
							<tooltip><![CDATA[SQL_ID]]></tooltip>
							<value><![CDATA[NULL_VALUE]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
						<bind id="ED_DT">
							<prompt><![CDATA[ED_DT]]></prompt>
							<tooltip><![CDATA[ED_DT]]></tooltip>
							<value><![CDATA[NULL_VALUE]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
					</binds>
				</query>
					<pdf version="VERSION_1_7" compression="CONTENT">
						<docproperty title="null" author="null" subject="null" keywords="null" />
						<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
						<column>
							<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
							<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
							<blob blob="NONE" zip="false" />
						</column>
						<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
						<header enable="false" generatedate="false">
							<data>
							
							
							
							
							
							
							
							null																																																								</data>
						</header>
						<footer enable="false" generatedate="false">
							<data value="null" />
						</footer>
						<security enable="false" useopenpassword="false" openpassword="null" encryption="EXCLUDE_METADATA">
							<permission enable="false" permissionpassword="null" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="false" />
						</security>
						<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
					</pdf>
			</display>
		</display>
		<display id="74f7449d-0157-1000-8048-0a02322027a3" type="" style="Table" enable="true">
			<name><![CDATA[Query on obj]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE>horizontal</TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[with t as (select /*+ MATERIALIZE PARALLEL(8) */ t.sql_id, P.PLAN_HASH_VALUE,  trim(max(DBMS_LOB.SUBSTR (sql_text,1000))) as sql_text 
from SYS.DBA_HIST_SQL_PLAN p
join dba_hist_sqltext t on t.sql_id = p.sql_id 
where upper(t.sql_text) like '%'||:tbl||'%'
and ( p.object_name = :obj or :obj is null )
group by t.sql_id, P.PLAN_HASH_VALUE )
select  h.sql_id, h.SQL_PLAN_HASH_VALUE, min(h.sample_time) as st_dt, max(h.sample_time) as ed_dt, count(*) as cnt, 
round(SUM (DELTA_READ_IO_REQUESTS)/1000,2) as rds_k,  round( SUM (delta_read_io_bytes)/1024/1024/1024, 2) as gb,
max(sql_text)  sql_text
from dba_hist_active_sess_history h
join t on t.sql_id = h.sql_id and t.PLAN_HASH_VALUE = h.SQL_PLAN_HASH_VALUE
where h.sample_time between to_date(:f, 'dd.mm.yyyy hh24:mi:ss') and to_date(:t, 'dd.mm.yyyy hh24:mi:ss')
group by h.sql_id, h.SQL_PLAN_HASH_VALUE
order by cnt desc]]></sql>
				<binds>
					<bind id="tbl">
						<prompt><![CDATA[tbl]]></prompt>
						<tooltip><![CDATA[tbl]]></tooltip>
						<value><![CDATA[MSEG]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="obj">
						<prompt><![CDATA[obj]]></prompt>
						<tooltip><![CDATA[obj]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="f">
						<prompt><![CDATA[f]]></prompt>
						<tooltip><![CDATA[f]]></tooltip>
						<value><![CDATA[17.10.2016]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="t">
						<prompt><![CDATA[t]]></prompt>
						<tooltip><![CDATA[t]]></tooltip>
						<value><![CDATA[24.10.2016]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="" author="" subject="" keywords="" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
						
						
						
						
						
						
						
				
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																										</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<security enable="false" useopenpassword="false" openpassword="" encryption="EXCLUDE_METADATA">
						<permission enable="false" permissionpassword="" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="true" />
					</security>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
			<display id="" type="" style="Table" enable="true">
				<name><![CDATA[plan]]></name>
				<description><![CDATA[]]></description>
				<tooltip><![CDATA[]]></tooltip>
				<drillclass><![CDATA[]]></drillclass>
				<CustomValues>
					<TYPE>horizontal</TYPE>
				</CustomValues>
				<query>
					<sql><![CDATA[select * from table(DBMS_XPLAN.DISPLAY_AWR(:SQL_ID, :SQL_PLAN_HASH_VALUE, null, 'basic +outline +peeked_binds') )]]></sql>
					<binds>
						<bind id="SQL_ID">
							<prompt><![CDATA[SQL_ID]]></prompt>
							<tooltip><![CDATA[SQL_ID]]></tooltip>
							<value><![CDATA[NULL_VALUE]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
						<bind id="SQL_PLAN_HASH_VALUE">
							<prompt><![CDATA[SQL_PLAN_HASH_VALUE]]></prompt>
							<tooltip><![CDATA[SQL_PLAN_HASH_VALUE]]></tooltip>
							<value><![CDATA[NULL_VALUE]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
					</binds>
				</query>
					<pdf version="VERSION_1_7" compression="CONTENT">
						<docproperty title="null" author="null" subject="null" keywords="null" />
						<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
						<column>
							<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
							<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
							<blob blob="NONE" zip="false" />
						</column>
						<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
						<header enable="false" generatedate="false">
							<data>
							
							
							
							
							
							
							
							null																																																								</data>
						</header>
						<footer enable="false" generatedate="false">
							<data value="null" />
						</footer>
						<security enable="false" useopenpassword="false" openpassword="null" encryption="EXCLUDE_METADATA">
							<permission enable="false" permissionpassword="null" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="false" />
						</security>
						<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
					</pdf>
			</display>
		</display>
		<display id="74fc2873-0157-1000-804a-0a02322027a3" type="" style="Table" enable="true">
			<name><![CDATA[Plan diff date]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE>horizontal</TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[with t as (
  select /*+ materialize */ trunc(t.begin_interval_time) as dt, sql_id, PLAN_HASH_VALUE, nvl(nullif( sum( EXECUTIONS_DELTA ),0),1) as execs,   round( sum( s.ELAPSED_TIME_DELTA ) / nvl(nullif( sum( EXECUTIONS_DELTA ),0),1) /1000/1000,2) as av_sec
  from DBA_HIST_SQLSTAT s
  join DBA_HIST_SNAPSHOT t on t.snap_id = s.snap_id and t.INSTANCE_NUMBER = s.INSTANCE_NUMBER
  where (  t.begin_interval_time between to_date(:f, 'dd.mm.yyyy') and to_date(:f, 'dd.mm.yyyy')+1 or 
    t.begin_interval_time between to_date(:t, 'dd.mm.yyyy') and to_date(:t, 'dd.mm.yyyy')+1
  )
  and s.parsing_schema_name NOT IN('DBSNMP', 'SYS', 'BRT$ADM', 'SYSTEM')
  group by trunc(t.begin_interval_time), sql_id, PLAN_HASH_VALUE
)
select t.sql_id, t.PLAN_HASH_VALUE, t.execs, t.av_sec, t1.PLAN_HASH_VALUE as SQL_PLAN_HASH_VALUE_OLD, t1.execs, t1.av_sec  , t.execs*t.av_sec - t.execs*nvl(t1.av_sec,0)  as diff, 
 round( (t.execs*t.av_sec - t.execs*nvl(t1.av_sec,0)) / SUM(t.execs*t.av_sec - t.execs*nvl(t1.av_sec,0))  OVER() * 100,2) as prc, trim(DBMS_LOB.SUBSTR (tx.sql_text,4000)) as sql_text 
from t
join dba_hist_sqltext tx on tx.sql_id = t.sql_id 
left join t t1 on t1.dt = to_date(:f, 'dd.mm.yyyy') and t.sql_id = t1.sql_id
where t.dt = to_date(:t, 'dd.mm.yyyy')
and ( ( t.PLAN_HASH_VALUE <> nvl(t1.PLAN_HASH_VALUE,0) AND nvl(:CH,0) = 1 ) OR ( t.PLAN_HASH_VALUE <> t1.PLAN_HASH_VALUE AND nvl(:CH,0) = 0 ) )
and (t.execs*t.av_sec - t.execs*nvl(t1.av_sec,0)) != 0
order by abs( t.execs*t.av_sec - t.execs*nvl(t1.av_sec,0) )  desc nulls last]]></sql>
				<binds>
					<bind id="f">
						<prompt><![CDATA[Раньше]]></prompt>
						<tooltip><![CDATA[f]]></tooltip>
						<value><![CDATA[18.10.2016]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="t">
						<prompt><![CDATA[Сейчас]]></prompt>
						<tooltip><![CDATA[t]]></tooltip>
						<value><![CDATA[25.10.2016]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="CH">
						<prompt><![CDATA[Включить новые]]></prompt>
						<tooltip><![CDATA[CH]]></tooltip>
						<value><![CDATA[0]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="" author="" subject="" keywords="" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
						
						
						
						
						
						
						
				
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																										</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<security enable="false" useopenpassword="false" openpassword="" encryption="EXCLUDE_METADATA">
						<permission enable="false" permissionpassword="" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="true" />
					</security>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
			<display id="" type="" style="Table" enable="true">
				<name><![CDATA[new_plan]]></name>
				<description><![CDATA[]]></description>
				<tooltip><![CDATA[]]></tooltip>
				<drillclass><![CDATA[]]></drillclass>
				<CustomValues>
					<TYPE>horizontal</TYPE>
				</CustomValues>
				<query>
					<sql><![CDATA[select * from table(DBMS_XPLAN.DISPLAY_AWR(:SQL_ID, :SQL_PLAN_HASH_VALUE, null, 'basic +outline +peeked_binds') )]]></sql>
				</query>
					<pdf version="VERSION_1_7" compression="CONTENT">
						<docproperty title="null" author="null" subject="null" keywords="null" />
						<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
						<column>
							<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
							<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
							<blob blob="NONE" zip="false" />
						</column>
						<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
						<header enable="false" generatedate="false">
							<data>
							
							
							
							
							
							
							
							null																																																								</data>
						</header>
						<footer enable="false" generatedate="false">
							<data value="null" />
						</footer>
						<security enable="false" useopenpassword="false" openpassword="null" encryption="EXCLUDE_METADATA">
							<permission enable="false" permissionpassword="null" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="false" />
						</security>
						<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
					</pdf>
			</display>
			<display id="" type="" style="Table" enable="true">
				<name><![CDATA[old_plan]]></name>
				<description><![CDATA[]]></description>
				<tooltip><![CDATA[]]></tooltip>
				<drillclass><![CDATA[]]></drillclass>
				<CustomValues>
					<TYPE>horizontal</TYPE>
				</CustomValues>
				<query>
					<sql><![CDATA[select * from table(DBMS_XPLAN.DISPLAY_AWR(:SQL_ID, :SQL_PLAN_HASH_VALUE_OLD, null, 'basic +outline +peeked_binds') )]]></sql>
				</query>
					<pdf version="VERSION_1_7" compression="CONTENT">
						<docproperty title="null" author="null" subject="null" keywords="null" />
						<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
						<column>
							<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
							<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
							<blob blob="NONE" zip="false" />
						</column>
						<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
						<header enable="false" generatedate="false">
							<data>
							
							
							
							
							
							
							
							null																																																								</data>
						</header>
						<footer enable="false" generatedate="false">
							<data value="null" />
						</footer>
						<security enable="false" useopenpassword="false" openpassword="null" encryption="EXCLUDE_METADATA">
							<permission enable="false" permissionpassword="null" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="false" />
						</security>
						<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
					</pdf>
			</display>
		</display>
		<folder>
			<name><![CDATA[graph]]></name>
			<tooltip><![CDATA[graph]]></tooltip>
			<description><![CDATA[ ]]></description>
				<display id="74b7342e-0157-1000-8015-0a02322027a3" type="" style="Chart" enable="true">
				<name><![CDATA[Buffer Cache Hit Ratio]]></name>
				<description><![CDATA[Logical Reads Per Sec, Buffer Cache Hit Ratio, Physical Reads Per Sec]]></description>
				<tooltip><![CDATA[]]></tooltip>
				<drillclass><![CDATA[]]></drillclass>
				<CustomValues>
					<PLOT_HGRID_WIDTH>THINNER</PLOT_HGRID_WIDTH>
					<Y1AXIS_SCALE_MINIMUM>60.0</Y1AXIS_SCALE_MINIMUM>
					<XAXIS_TICK_LABEL_AUTO_ROTATE>true</XAXIS_TICK_LABEL_AUTO_ROTATE>
					<Y1AXIS_SCALE_INCREMENT>10.0</Y1AXIS_SCALE_INCREMENT>
					<Y2AXIS_SCALE_MAXIMUM>80.0</Y2AXIS_SCALE_MAXIMUM>
					<Y1AXIS_LINE_WIDTH>THINNEST</Y1AXIS_LINE_WIDTH>
					<Y1AXIS_SCALE_MAXIMUM_AUTOMATIC>false</Y1AXIS_SCALE_MAXIMUM_AUTOMATIC>
					<Y1AXIS_TITLE_ALIGNMENT>CENTER</Y1AXIS_TITLE_ALIGNMENT>
					<LEGEND_LOCATION>AUTOMATIC</LEGEND_LOCATION>
					<LEGEND_ALIGNMENT>LEFT</LEGEND_ALIGNMENT>
					<GRADIENT>false</GRADIENT>
					<XAXIS_LINE_WIDTH>THINNEST</XAXIS_LINE_WIDTH>
					<LEGEND>false</LEGEND>
					<Y1AXIS_SCALE_MAXIMUM>100.0</Y1AXIS_SCALE_MAXIMUM>
					<XAXIS_TITLE_ALIGNMENT>CENTER</XAXIS_TITLE_ALIGNMENT>
					<PLOT_DATALABELS>false</PLOT_DATALABELS>
					<XAXIS_TICK_LABEL_ROTATE>HORIZONTAL</XAXIS_TICK_LABEL_ROTATE>
					<Y1AXIS_LOGARITHMIC_BASE>BASE_10</Y1AXIS_LOGARITHMIC_BASE>
					<TYPE>LINE_VERT_ABS</TYPE>
					<GRID_WIDTH>THINNER</GRID_WIDTH>
					<PLOT_DATALABELS_BAR_POSITION>ABOVE</PLOT_DATALABELS_BAR_POSITION>
					<FOOTNOTE_ALIGNMENT>LEFT</FOOTNOTE_ALIGNMENT>
					<XAXIS_TICK_LABEL_SKIP_MODE>AUTOMATIC</XAXIS_TICK_LABEL_SKIP_MODE>
					<Y2AXIS_LOGARITHMIC_BASE>BASE_10</Y2AXIS_LOGARITHMIC_BASE>
					<GRID>true</GRID>
					<STYLE>Default</STYLE>
					<TITLE_ALIGNMENT>LEFT</TITLE_ALIGNMENT>
					<Y1AXIS_SCALE_MINIMUM_AUTOMATIC>false</Y1AXIS_SCALE_MINIMUM_AUTOMATIC>
					<Y2AXIS_TICK_LABEL_ROTATE>HORIZONTAL</Y2AXIS_TICK_LABEL_ROTATE>
					<Y2AXIS_SCALE_MINIMUM>10.0</Y2AXIS_SCALE_MINIMUM>
					<THREED>false</THREED>
					<Y2AXIS_LINE_WIDTH>THINNEST</Y2AXIS_LINE_WIDTH>
					<Y1AXIS_TICK_LABEL_ROTATE>HORIZONTAL</Y1AXIS_TICK_LABEL_ROTATE>
					<Y1AXIS_TITLE>false</Y1AXIS_TITLE>
					<Y2AXIS_SCALE_INCREMENT>20.0</Y2AXIS_SCALE_INCREMENT>
					<PLOT_VGRID_WIDTH>THINNER</PLOT_VGRID_WIDTH>
					<Y2AXIS_TITLE_ALIGNMENT>CENTER</Y2AXIS_TITLE_ALIGNMENT>
					<SUBTITLE_ALIGNMENT>LEFT</SUBTITLE_ALIGNMENT>
				</CustomValues>
				<query>
					<sql><![CDATA[select to_char(s.begin_time, 'dd-mm hh24') as hh, null as col1 , avg(s.average) as y 
from DBA_HIST_SYSMETRIC_SUMMARY  s
where s.begin_time between to_date(:f, 'dd.mm.yyyy hh24:mi:ss') and to_date(:t, 'dd.mm.yyyy hh24:mi:ss')
and S.INSTANCE_NUMBER = 2
and metric_name = :m
group by to_char(s.begin_time, 'dd-mm hh24'), to_char(s.begin_time, 'hh24'), trunc(s.begin_time)
order by trunc(s.begin_time), to_char(s.begin_time, 'hh24') asc]]></sql>
					<binds>
						<bind id="f">
							<prompt><![CDATA[С]]></prompt>
							<tooltip><![CDATA[f]]></tooltip>
							<value><![CDATA[17.10.2016]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
						<bind id="t">
							<prompt><![CDATA[По]]></prompt>
							<tooltip><![CDATA[t]]></tooltip>
							<value><![CDATA[24.10.2016]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
						<bind id="m">
							<prompt><![CDATA[Метрика]]></prompt>
							<tooltip><![CDATA[m]]></tooltip>
							<value><![CDATA[Buffer Cache Hit Ratio]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
					</binds>
				</query>
					<pdf version="VERSION_1_7" compression="CONTENT">
						<docproperty title="null" author="null" subject="null" keywords="null" />
						<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
						<column>
							<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
							<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
							<blob blob="NONE" zip="false" />
						</column>
						<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
						<header enable="false" generatedate="false">
							<data>
							
							
							
							
							
							
							
							null																																																								</data>
						</header>
						<footer enable="false" generatedate="false">
							<data value="null" />
						</footer>
						<security enable="false" useopenpassword="false" openpassword="null" encryption="EXCLUDE_METADATA">
							<permission enable="false" permissionpassword="null" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="false" />
						</security>
						<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
					</pdf>
			</display>
			<display id="7509f473-0157-1000-8053-0a02322027a3" type="" style="Chart" enable="true">
				<name><![CDATA[Logical Reads Per Sec]]></name>
				<description><![CDATA[Logical Reads Per Sec, Buffer Cache Hit Ratio, Physical Reads Per Sec]]></description>
				<tooltip><![CDATA[]]></tooltip>
				<drillclass><![CDATA[]]></drillclass>
				<CustomValues>
					<PLOT_HGRID_WIDTH>THINNER</PLOT_HGRID_WIDTH>
					<XAXIS_TICK_LABEL_AUTO_ROTATE>true</XAXIS_TICK_LABEL_AUTO_ROTATE>
					<Y1AXIS_SCALE_INCREMENT>10.0</Y1AXIS_SCALE_INCREMENT>
					<Y2AXIS_SCALE_MAXIMUM>80.0</Y2AXIS_SCALE_MAXIMUM>
					<Y1AXIS_LINE_WIDTH>THINNEST</Y1AXIS_LINE_WIDTH>
					<Y1AXIS_TITLE_ALIGNMENT>CENTER</Y1AXIS_TITLE_ALIGNMENT>
					<LEGEND_LOCATION>AUTOMATIC</LEGEND_LOCATION>
					<LEGEND_ALIGNMENT>LEFT</LEGEND_ALIGNMENT>
					<GRADIENT>false</GRADIENT>
					<XAXIS_LINE_WIDTH>THINNEST</XAXIS_LINE_WIDTH>
					<LEGEND>false</LEGEND>
					<Y1AXIS_SCALE_MAXIMUM>80.0</Y1AXIS_SCALE_MAXIMUM>
					<XAXIS_TITLE_ALIGNMENT>CENTER</XAXIS_TITLE_ALIGNMENT>
					<XAXIS_TICK_LABEL_ROTATE>HORIZONTAL</XAXIS_TICK_LABEL_ROTATE>
					<Y1AXIS_LOGARITHMIC_BASE>BASE_10</Y1AXIS_LOGARITHMIC_BASE>
					<TYPE>LINE_VERT_ABS</TYPE>
					<GRID_WIDTH>THINNER</GRID_WIDTH>
					<PLOT_DATALABELS_BAR_POSITION>ABOVE</PLOT_DATALABELS_BAR_POSITION>
					<FOOTNOTE_ALIGNMENT>LEFT</FOOTNOTE_ALIGNMENT>
					<XAXIS_TICK_LABEL_SKIP_MODE>AUTOMATIC</XAXIS_TICK_LABEL_SKIP_MODE>
					<Y2AXIS_LOGARITHMIC_BASE>BASE_10</Y2AXIS_LOGARITHMIC_BASE>
					<GRID>true</GRID>
					<STYLE>Default</STYLE>
					<TITLE_ALIGNMENT>LEFT</TITLE_ALIGNMENT>
					<Y2AXIS_TICK_LABEL_ROTATE>HORIZONTAL</Y2AXIS_TICK_LABEL_ROTATE>
					<Y2AXIS_SCALE_MINIMUM>10.0</Y2AXIS_SCALE_MINIMUM>
					<THREED>false</THREED>
					<Y2AXIS_LINE_WIDTH>THINNEST</Y2AXIS_LINE_WIDTH>
					<Y1AXIS_TICK_LABEL_ROTATE>HORIZONTAL</Y1AXIS_TICK_LABEL_ROTATE>
					<Y2AXIS_SCALE_INCREMENT>20.0</Y2AXIS_SCALE_INCREMENT>
					<PLOT_VGRID_WIDTH>THINNER</PLOT_VGRID_WIDTH>
					<Y2AXIS_TITLE_ALIGNMENT>CENTER</Y2AXIS_TITLE_ALIGNMENT>
					<SUBTITLE_ALIGNMENT>LEFT</SUBTITLE_ALIGNMENT>
				</CustomValues>
				<query>
					<sql><![CDATA[select to_char(s.begin_time, 'dd-mm hh24') as hh, null as col1 , avg(s.average) as y 
from DBA_HIST_SYSMETRIC_SUMMARY  s
where s.begin_time between to_date(:f, 'dd.mm.yyyy hh24:mi:ss') and to_date(:t, 'dd.mm.yyyy hh24:mi:ss')
and S.INSTANCE_NUMBER = 2
and metric_name = :m
group by to_char(s.begin_time, 'dd-mm hh24'), to_char(s.begin_time, 'hh24'), trunc(s.begin_time)
order by trunc(s.begin_time), to_char(s.begin_time, 'hh24') asc]]></sql>
					<binds>
						<bind id="f">
							<prompt><![CDATA[С]]></prompt>
							<tooltip><![CDATA[f]]></tooltip>
							<value><![CDATA[17.10.2016]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
						<bind id="t">
							<prompt><![CDATA[По]]></prompt>
							<tooltip><![CDATA[t]]></tooltip>
							<value><![CDATA[24.10.2016]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
						<bind id="m">
							<prompt><![CDATA[Метрика]]></prompt>
							<tooltip><![CDATA[m]]></tooltip>
							<value><![CDATA[Logical Reads Per Sec]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
					</binds>
				</query>
					<pdf version="VERSION_1_7" compression="CONTENT">
						<docproperty title="null" author="null" subject="null" keywords="null" />
						<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
						<column>
							<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
							<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
							<blob blob="NONE" zip="false" />
						</column>
						<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
						<header enable="false" generatedate="false">
							<data>
							
							
							
							
							
							
							
							
				null																																																												</data>
						</header>
						<footer enable="false" generatedate="false">
							<data value="null" />
						</footer>
						<security enable="false" useopenpassword="false" openpassword="null" encryption="EXCLUDE_METADATA">
							<permission enable="false" permissionpassword="null" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="false" />
						</security>
						<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
					</pdf>
			</display>
			<display id="750b168c-0157-1000-8057-0a02322027a3" type="" style="Chart" enable="true">
				<name><![CDATA[Physical Reads Per Sec]]></name>
				<description><![CDATA[Logical Reads Per Sec, Buffer Cache Hit Ratio, Physical Reads Per Sec]]></description>
				<tooltip><![CDATA[]]></tooltip>
				<drillclass><![CDATA[]]></drillclass>
				<CustomValues>
					<PLOT_HGRID_WIDTH>THINNER</PLOT_HGRID_WIDTH>
					<XAXIS_TICK_LABEL_AUTO_ROTATE>true</XAXIS_TICK_LABEL_AUTO_ROTATE>
					<Y1AXIS_SCALE_INCREMENT>10.0</Y1AXIS_SCALE_INCREMENT>
					<Y2AXIS_SCALE_MAXIMUM>80.0</Y2AXIS_SCALE_MAXIMUM>
					<Y1AXIS_LINE_WIDTH>THINNEST</Y1AXIS_LINE_WIDTH>
					<Y1AXIS_TITLE_ALIGNMENT>CENTER</Y1AXIS_TITLE_ALIGNMENT>
					<LEGEND_LOCATION>AUTOMATIC</LEGEND_LOCATION>
					<LEGEND_ALIGNMENT>LEFT</LEGEND_ALIGNMENT>
					<GRADIENT>false</GRADIENT>
					<XAXIS_LINE_WIDTH>THINNEST</XAXIS_LINE_WIDTH>
					<LEGEND>false</LEGEND>
					<Y1AXIS_SCALE_MAXIMUM>80.0</Y1AXIS_SCALE_MAXIMUM>
					<XAXIS_TITLE_ALIGNMENT>CENTER</XAXIS_TITLE_ALIGNMENT>
					<XAXIS_TICK_LABEL_ROTATE>HORIZONTAL</XAXIS_TICK_LABEL_ROTATE>
					<Y1AXIS_LOGARITHMIC_BASE>BASE_10</Y1AXIS_LOGARITHMIC_BASE>
					<TYPE>LINE_VERT_ABS</TYPE>
					<GRID_WIDTH>THINNER</GRID_WIDTH>
					<PLOT_DATALABELS_BAR_POSITION>ABOVE</PLOT_DATALABELS_BAR_POSITION>
					<FOOTNOTE_ALIGNMENT>LEFT</FOOTNOTE_ALIGNMENT>
					<XAXIS_TICK_LABEL_SKIP_MODE>AUTOMATIC</XAXIS_TICK_LABEL_SKIP_MODE>
					<Y2AXIS_LOGARITHMIC_BASE>BASE_10</Y2AXIS_LOGARITHMIC_BASE>
					<GRID>true</GRID>
					<STYLE>Default</STYLE>
					<TITLE_ALIGNMENT>LEFT</TITLE_ALIGNMENT>
					<Y2AXIS_TICK_LABEL_ROTATE>HORIZONTAL</Y2AXIS_TICK_LABEL_ROTATE>
					<Y2AXIS_SCALE_MINIMUM>10.0</Y2AXIS_SCALE_MINIMUM>
					<THREED>false</THREED>
					<Y2AXIS_LINE_WIDTH>THINNEST</Y2AXIS_LINE_WIDTH>
					<Y1AXIS_TICK_LABEL_ROTATE>HORIZONTAL</Y1AXIS_TICK_LABEL_ROTATE>
					<Y2AXIS_SCALE_INCREMENT>20.0</Y2AXIS_SCALE_INCREMENT>
					<PLOT_VGRID_WIDTH>THINNER</PLOT_VGRID_WIDTH>
					<Y2AXIS_TITLE_ALIGNMENT>CENTER</Y2AXIS_TITLE_ALIGNMENT>
					<SUBTITLE_ALIGNMENT>LEFT</SUBTITLE_ALIGNMENT>
				</CustomValues>
				<query>
					<sql><![CDATA[select to_char(s.begin_time, 'dd-mm hh24') as hh, null as col1 , avg(s.average) as y 
from DBA_HIST_SYSMETRIC_SUMMARY  s
where s.begin_time between to_date(:f, 'dd.mm.yyyy hh24:mi:ss') and to_date(:t, 'dd.mm.yyyy hh24:mi:ss')
and S.INSTANCE_NUMBER = 2
and metric_name = :m
group by to_char(s.begin_time, 'dd-mm hh24'), to_char(s.begin_time, 'hh24'), trunc(s.begin_time)
order by trunc(s.begin_time), to_char(s.begin_time, 'hh24') asc]]></sql>
					<binds>
						<bind id="f">
							<prompt><![CDATA[С]]></prompt>
							<tooltip><![CDATA[f]]></tooltip>
							<value><![CDATA[17.10.2016]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
						<bind id="t">
							<prompt><![CDATA[По]]></prompt>
							<tooltip><![CDATA[t]]></tooltip>
							<value><![CDATA[24.10.2016]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
						<bind id="m">
							<prompt><![CDATA[Метрика]]></prompt>
							<tooltip><![CDATA[m]]></tooltip>
							<value><![CDATA[Physical Reads Per Sec]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
					</binds>
				</query>
					<pdf version="VERSION_1_7" compression="CONTENT">
						<docproperty title="null" author="null" subject="null" keywords="null" />
						<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
						<column>
							<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
							<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
							<blob blob="NONE" zip="false" />
						</column>
						<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
						<header enable="false" generatedate="false">
							<data>
							
							
							
							
							
							
							
							
				null																																																												</data>
						</header>
						<footer enable="false" generatedate="false">
							<data value="null" />
						</footer>
						<security enable="false" useopenpassword="false" openpassword="null" encryption="EXCLUDE_METADATA">
							<permission enable="false" permissionpassword="null" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="false" />
						</security>
						<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
					</pdf>
			</display>
			<display id="74ccb560-0157-1000-802f-0a02322027a3" type="" style="Chart" enable="true">
				<name><![CDATA[Нагрузка ash]]></name>
				<description><![CDATA[]]></description>
				<tooltip><![CDATA[]]></tooltip>
				<drillclass><![CDATA[]]></drillclass>
				<CustomValues>
					<PLOT_HGRID_WIDTH>THINNER</PLOT_HGRID_WIDTH>
					<PLOT_DATATIPS_TEXT>true</PLOT_DATATIPS_TEXT>
					<XAXIS_TICK_LABEL_AUTO_ROTATE>true</XAXIS_TICK_LABEL_AUTO_ROTATE>
					<Y1AXIS_SCALE_INCREMENT>10.0</Y1AXIS_SCALE_INCREMENT>
					<Y2AXIS_SCALE_MAXIMUM>80.0</Y2AXIS_SCALE_MAXIMUM>
					<Y1AXIS_LINE_WIDTH>THINNEST</Y1AXIS_LINE_WIDTH>
					<Y1AXIS_TITLE_ALIGNMENT>CENTER</Y1AXIS_TITLE_ALIGNMENT>
					<LEGEND_LOCATION>AUTOMATIC</LEGEND_LOCATION>
					<PLOT_DATALABELS_NUMBER_FORMATS.CURRENCY_SYMBOL>DOLLARS</PLOT_DATALABELS_NUMBER_FORMATS.CURRENCY_SYMBOL>
					<LEGEND_ALIGNMENT>LEFT</LEGEND_ALIGNMENT>
					<GRADIENT>false</GRADIENT>
					<XAXIS_LINE_WIDTH>THINNEST</XAXIS_LINE_WIDTH>
					<LEGEND>false</LEGEND>
					<PLOT_DATALABELS_NUMBER_FORMATS.SCALE_FACTOR>NONE</PLOT_DATALABELS_NUMBER_FORMATS.SCALE_FACTOR>
					<Y1AXIS_SCALE_MAXIMUM>80.0</Y1AXIS_SCALE_MAXIMUM>
					<XAXIS_TITLE_ALIGNMENT>CENTER</XAXIS_TITLE_ALIGNMENT>
					<PLOT_DATALABELS>true</PLOT_DATALABELS>
					<XAXIS_TICK_LABEL_ROTATE>HORIZONTAL</XAXIS_TICK_LABEL_ROTATE>
					<Y1AXIS_LOGARITHMIC_BASE>BASE_10</Y1AXIS_LOGARITHMIC_BASE>
					<TYPE>LINE_VERT_ABS</TYPE>
					<GRID_WIDTH>THINNER</GRID_WIDTH>
					<PLOT_DATALABELS_BAR_POSITION>ABOVE</PLOT_DATALABELS_BAR_POSITION>
					<FOOTNOTE_ALIGNMENT>LEFT</FOOTNOTE_ALIGNMENT>
					<XAXIS_TICK_LABEL_SKIP_MODE>AUTOMATIC</XAXIS_TICK_LABEL_SKIP_MODE>
					<PLOT_DATALABELS_NUMBER_FORMATS.NEGATIVE_NUMBER_FORMAT>BRACKETED</PLOT_DATALABELS_NUMBER_FORMATS.NEGATIVE_NUMBER_FORMAT>
					<Y2AXIS_LOGARITHMIC_BASE>BASE_10</Y2AXIS_LOGARITHMIC_BASE>
					<GRID>true</GRID>
					<STYLE>Default</STYLE>
					<TITLE_ALIGNMENT>LEFT</TITLE_ALIGNMENT>
					<PLOT_DATALABELS_NUMBER_FORMATS.DECIMAL_PLACES>0</PLOT_DATALABELS_NUMBER_FORMATS.DECIMAL_PLACES>
					<Y2AXIS_TICK_LABEL_ROTATE>HORIZONTAL</Y2AXIS_TICK_LABEL_ROTATE>
					<Y2AXIS_SCALE_MINIMUM>10.0</Y2AXIS_SCALE_MINIMUM>
					<PLOT_HGRID>true</PLOT_HGRID>
					<THREED>false</THREED>
					<Y2AXIS_LINE_WIDTH>THINNEST</Y2AXIS_LINE_WIDTH>
					<Y1AXIS_TICK_LABEL_ROTATE>HORIZONTAL</Y1AXIS_TICK_LABEL_ROTATE>
					<PLOT_DATALABELS_NUMBER_FORMATS.TYPE>NUMBER</PLOT_DATALABELS_NUMBER_FORMATS.TYPE>
					<Y2AXIS_SCALE_INCREMENT>20.0</Y2AXIS_SCALE_INCREMENT>
					<PLOT_VGRID_WIDTH>THINNER</PLOT_VGRID_WIDTH>
					<PLOT_SERIES_OPTIONS_MARKER_SHAPE>\,SQUARE,SQUARE,SQUARE,AUTOMATIC,AUTOMATIC</PLOT_SERIES_OPTIONS_MARKER_SHAPE>
					<Y2AXIS_TITLE_ALIGNMENT>CENTER</Y2AXIS_TITLE_ALIGNMENT>
					<SUBTITLE_ALIGNMENT>LEFT</SUBTITLE_ALIGNMENT>
				</CustomValues>
				<query>
					<sql><![CDATA[select /*+ parallel(8) */  to_char(sample_time, 'dd-mm hh24') as hh, null as col1, count(*) as cnt
  from dba_hist_active_sess_history h
  where 
    h.sample_time >= trunc(sysdate-10)
  group by trunc(sample_time), to_char(sample_time, 'hh24') , to_char(sample_time, 'dd-mm hh24')
  order by trunc(sample_time) asc, to_char(sample_time, 'hh24') asc]]></sql>
				</query>
					<pdf version="VERSION_1_7" compression="CONTENT">
						<docproperty title="null" author="null" subject="null" keywords="null" />
						<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
						<column>
							<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
							<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
							<blob blob="NONE" zip="false" />
						</column>
						<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
						<header enable="false" generatedate="false">
							<data>
							
							
							
							
							
							
							
							
				null																																																												</data>
						</header>
						<footer enable="false" generatedate="false">
							<data value="null" />
						</footer>
						<security enable="false" useopenpassword="false" openpassword="null" encryption="EXCLUDE_METADATA">
							<permission enable="false" permissionpassword="null" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="false" />
						</security>
						<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
					</pdf>
			</display>
			<display id="74e08e2c-0157-1000-803d-0a02322027a3" type="" style="Chart" enable="true">
				<name><![CDATA[Нагрузка по дням]]></name>
				<description><![CDATA[]]></description>
				<tooltip><![CDATA[]]></tooltip>
				<drillclass><![CDATA[]]></drillclass>
				<CustomValues>
					<PLOT_HGRID_WIDTH>THINNER</PLOT_HGRID_WIDTH>
					<XAXIS_TICK_LABEL_AUTO_ROTATE>true</XAXIS_TICK_LABEL_AUTO_ROTATE>
					<Y1AXIS_SCALE_INCREMENT>10.0</Y1AXIS_SCALE_INCREMENT>
					<Y2AXIS_SCALE_MAXIMUM>80.0</Y2AXIS_SCALE_MAXIMUM>
					<Y1AXIS_LINE_WIDTH>THINNEST</Y1AXIS_LINE_WIDTH>
					<Y1AXIS_TITLE_ALIGNMENT>CENTER</Y1AXIS_TITLE_ALIGNMENT>
					<LEGEND_LOCATION>AUTOMATIC</LEGEND_LOCATION>
					<LEGEND_ALIGNMENT>LEFT</LEGEND_ALIGNMENT>
					<GRADIENT>false</GRADIENT>
					<XAXIS_LINE_WIDTH>THINNEST</XAXIS_LINE_WIDTH>
					<LEGEND>true</LEGEND>
					<DATA_MAP_COLUMNS>\,"DT"</DATA_MAP_COLUMNS>
					<Y1AXIS_SCALE_MAXIMUM>80.0</Y1AXIS_SCALE_MAXIMUM>
					<XAXIS_TITLE_ALIGNMENT>CENTER</XAXIS_TITLE_ALIGNMENT>
					<PLOT_DATALABELS>false</PLOT_DATALABELS>
					<XAXIS_TICK_LABEL_ROTATE>HORIZONTAL</XAXIS_TICK_LABEL_ROTATE>
					<Y1AXIS_LOGARITHMIC_BASE>BASE_10</Y1AXIS_LOGARITHMIC_BASE>
					<TYPE>BAR_VERT_CLUST</TYPE>
					<GRID_WIDTH>THINNER</GRID_WIDTH>
					<PLOT_DATALABELS_BAR_POSITION>CENTERED</PLOT_DATALABELS_BAR_POSITION>
					<FOOTNOTE_ALIGNMENT>LEFT</FOOTNOTE_ALIGNMENT>
					<XAXIS_TICK_LABEL_SKIP_MODE>AUTOMATIC</XAXIS_TICK_LABEL_SKIP_MODE>
					<DATA_MAP_COLNAMES>\,"DT","SMPL","WW"</DATA_MAP_COLNAMES>
					<DATA_MAP_SERIES>\,"WW"</DATA_MAP_SERIES>
					<Y2AXIS_LOGARITHMIC_BASE>BASE_10</Y2AXIS_LOGARITHMIC_BASE>
					<GRID>true</GRID>
					<DATA_MAP_COUNT>1</DATA_MAP_COUNT>
					<STYLE>Default</STYLE>
					<TITLE_ALIGNMENT>LEFT</TITLE_ALIGNMENT>
					<Y2AXIS_TICK_LABEL_ROTATE>HORIZONTAL</Y2AXIS_TICK_LABEL_ROTATE>
					<Y2AXIS_SCALE_MINIMUM>10.0</Y2AXIS_SCALE_MINIMUM>
					<THREED>false</THREED>
					<Y2AXIS_LINE_WIDTH>THINNEST</Y2AXIS_LINE_WIDTH>
					<DATA_MAP_VALUES>\,"SMPL"</DATA_MAP_VALUES>
					<Y1AXIS_TICK_LABEL_ROTATE>HORIZONTAL</Y1AXIS_TICK_LABEL_ROTATE>
					<Y2AXIS_SCALE_INCREMENT>20.0</Y2AXIS_SCALE_INCREMENT>
					<PLOT_VGRID_WIDTH>THINNER</PLOT_VGRID_WIDTH>
					<Y2AXIS_TITLE_ALIGNMENT>CENTER</Y2AXIS_TITLE_ALIGNMENT>
					<SUBTITLE_ALIGNMENT>LEFT</SUBTITLE_ALIGNMENT>
				</CustomValues>
				<query>
					<sql><![CDATA[select /*+ parallel(8) */ dt, ww, case when nvl(:avg,0) = 1 then avg(smpl) else sum(smpl) end smpl from (
  select  to_char(h.sample_time,'IW') as ww, to_char(h.sample_time, 'D')||'_'||to_char(h.sample_time, 'DAY') as dt, count(*) smpl 
  from dba_hist_active_sess_history h
  where 
    h.sample_time >= trunc(sysdate-60, 'mm')
  group by to_char(h.sample_time, 'D')||'_'||to_char(h.sample_time, 'DAY'), to_char(h.sample_time,'IW'), to_char(h.sample_time,'hh24mi')
)
group by ww, dt
order by dt, ww]]></sql>
					<binds>
						<bind id="avg">
							<prompt><![CDATA[среднее=1, общая=0]]></prompt>
							<tooltip><![CDATA[avg]]></tooltip>
							<value><![CDATA[1]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
					</binds>
				</query>
					<pdf version="VERSION_1_7" compression="CONTENT">
						<docproperty title="null" author="null" subject="null" keywords="null" />
						<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
						<column>
							<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
							<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
							<blob blob="NONE" zip="false" />
						</column>
						<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
						<header enable="false" generatedate="false">
							<data>
							
							
							
							
							
							
							
							
				null																																																												</data>
						</header>
						<footer enable="false" generatedate="false">
							<data value="null" />
						</footer>
						<security enable="false" useopenpassword="false" openpassword="null" encryption="EXCLUDE_METADATA">
							<permission enable="false" permissionpassword="null" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="false" />
						</security>
						<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
					</pdf>
			</display>
			<display id="74d76741-0157-1000-8039-0a02322027a3" type="" style="Chart" enable="true">
				<name><![CDATA[Таблицы в кэше]]></name>
				<description><![CDATA[]]></description>
				<tooltip><![CDATA[]]></tooltip>
				<drillclass><![CDATA[]]></drillclass>
				<CustomValues>
					<PLOT_HGRID_WIDTH>THINNER</PLOT_HGRID_WIDTH>
					<XAXIS_TICK_LABEL_AUTO_ROTATE>true</XAXIS_TICK_LABEL_AUTO_ROTATE>
					<Y1AXIS_SCALE_INCREMENT>10.0</Y1AXIS_SCALE_INCREMENT>
					<Y2AXIS_SCALE_MAXIMUM>80.0</Y2AXIS_SCALE_MAXIMUM>
					<Y1AXIS_LINE_WIDTH>THINNEST</Y1AXIS_LINE_WIDTH>
					<Y1AXIS_TITLE_ALIGNMENT>CENTER</Y1AXIS_TITLE_ALIGNMENT>
					<LEGEND_LOCATION>AUTOMATIC</LEGEND_LOCATION>
					<Y1AXIS_REFOBJ_COUNT>0</Y1AXIS_REFOBJ_COUNT>
					<LEGEND_ALIGNMENT>LEFT</LEGEND_ALIGNMENT>
					<GRADIENT>false</GRADIENT>
					<XAXIS_LINE_WIDTH>THINNEST</XAXIS_LINE_WIDTH>
					<Y1AXIS_REFOBJ_LINE_VALUE>\</Y1AXIS_REFOBJ_LINE_VALUE>
					<LEGEND>true</LEGEND>
					<Y1AXIS_SCALE_MAXIMUM>80.0</Y1AXIS_SCALE_MAXIMUM>
					<XAXIS_TITLE_ALIGNMENT>CENTER</XAXIS_TITLE_ALIGNMENT>
					<PLOT_DATALABELS>false</PLOT_DATALABELS>
					<XAXIS_LOGARITHMIC_BASE>BASE_10</XAXIS_LOGARITHMIC_BASE>
					<XAXIS_TICK_LABEL_ROTATE>HORIZONTAL</XAXIS_TICK_LABEL_ROTATE>
					<Y1AXIS_LOGARITHMIC_BASE>BASE_10</Y1AXIS_LOGARITHMIC_BASE>
					<TYPE>LINE_VERT_ABS</TYPE>
					<GRID_WIDTH>THINNER</GRID_WIDTH>
					<PLOT_DATALABELS_BAR_POSITION>ABOVE</PLOT_DATALABELS_BAR_POSITION>
					<FOOTNOTE_ALIGNMENT>LEFT</FOOTNOTE_ALIGNMENT>
					<XAXIS_TICK_LABEL_SKIP_MODE>AUTOMATIC</XAXIS_TICK_LABEL_SKIP_MODE>
					<Y1AXIS_REFOBJ_VISIBLE>\</Y1AXIS_REFOBJ_VISIBLE>
					<Y2AXIS_LOGARITHMIC_BASE>BASE_10</Y2AXIS_LOGARITHMIC_BASE>
					<GRID>true</GRID>
					<STYLE>Default</STYLE>
					<TITLE_ALIGNMENT>LEFT</TITLE_ALIGNMENT>
					<XAXIS_SCALE_INCREMENT>10.0</XAXIS_SCALE_INCREMENT>
					<XAXIS_SCALE_MAXIMUM>70.0</XAXIS_SCALE_MAXIMUM>
					<Y2AXIS_TICK_LABEL_ROTATE>HORIZONTAL</Y2AXIS_TICK_LABEL_ROTATE>
					<Y2AXIS_SCALE_MINIMUM>10.0</Y2AXIS_SCALE_MINIMUM>
					<THREED>false</THREED>
					<Y2AXIS_LINE_WIDTH>THINNEST</Y2AXIS_LINE_WIDTH>
					<Y1AXIS_TICK_LABEL_ROTATE>HORIZONTAL</Y1AXIS_TICK_LABEL_ROTATE>
					<Y1AXIS_REFOBJ_TEXT>\</Y1AXIS_REFOBJ_TEXT>
					<Y1AXIS_REFOBJ_WIDTH>\</Y1AXIS_REFOBJ_WIDTH>
					<Y1AXIS_TITLE>false</Y1AXIS_TITLE>
					<Y2AXIS_SCALE_INCREMENT>20.0</Y2AXIS_SCALE_INCREMENT>
					<PLOT_VGRID_WIDTH>THINNER</PLOT_VGRID_WIDTH>
					<Y2AXIS_TITLE_ALIGNMENT>CENTER</Y2AXIS_TITLE_ALIGNMENT>
					<SUBTITLE_ALIGNMENT>LEFT</SUBTITLE_ALIGNMENT>
					<Y1AXIS_REFOBJ_COLOR>\</Y1AXIS_REFOBJ_COLOR>
				</CustomValues>
				<query>
					<sql><![CDATA[SELECT to_char("STAT$BH".SNAP_DATE, 'dd-mm hh24') as hh, "STAT$BH".OBJ_NAME, avg("STAT$BH".PCT) as pct
FROM DBSNMP."STAT$BH" "STAT$BH"
WHERE ("STAT$BH".PCT>=:prc) and snap_date >= trunc(SYSDATE-:d)
group by to_char("STAT$BH".SNAP_DATE, 'dd-mm hh24'), "STAT$BH".OBJ_NAME, trunc("STAT$BH".SNAP_DATE), to_char("STAT$BH".SNAP_DATE, 'hh24')
ORDER BY trunc("STAT$BH".SNAP_DATE), to_char("STAT$BH".SNAP_DATE, 'hh24') asc, "STAT$BH".OBJ_NAME asc]]></sql>
					<binds>
						<bind id="prc">
							<prompt><![CDATA[%]]></prompt>
							<tooltip><![CDATA[prc]]></tooltip>
							<value><![CDATA[7]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
						<bind id="d">
							<prompt><![CDATA[Дней]]></prompt>
							<tooltip><![CDATA[d]]></tooltip>
							<value><![CDATA[2]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
					</binds>
				</query>
					<pdf version="VERSION_1_7" compression="CONTENT">
						<docproperty title="null" author="null" subject="null" keywords="null" />
						<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
						<column>
							<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
							<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
							<blob blob="NONE" zip="false" />
						</column>
						<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
						<header enable="false" generatedate="false">
							<data>
							
							
							
							
							
							
							
							
				null																																																												</data>
						</header>
						<footer enable="false" generatedate="false">
							<data value="null" />
						</footer>
						<security enable="false" useopenpassword="false" openpassword="null" encryption="EXCLUDE_METADATA">
							<permission enable="false" permissionpassword="null" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="false" />
						</security>
						<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
					</pdf>
			</display>
			<display id="75bb8f50-0157-1000-8070-0a02322027a3" type="" style="Chart" enable="true">
				<name><![CDATA[Table top reads]]></name>
				<description><![CDATA[]]></description>
				<tooltip><![CDATA[]]></tooltip>
				<drillclass><![CDATA[]]></drillclass>
				<CustomValues>
					<PLOT_HGRID_WIDTH>THINNER</PLOT_HGRID_WIDTH>
					<XAXIS_TICK_LABEL_AUTO_ROTATE>true</XAXIS_TICK_LABEL_AUTO_ROTATE>
					<Y1AXIS_SCALE_INCREMENT>10.0</Y1AXIS_SCALE_INCREMENT>
					<Y2AXIS_SCALE_MAXIMUM>80.0</Y2AXIS_SCALE_MAXIMUM>
					<Y1AXIS_LINE_WIDTH>THINNEST</Y1AXIS_LINE_WIDTH>
					<Y1AXIS_TITLE_ALIGNMENT>CENTER</Y1AXIS_TITLE_ALIGNMENT>
					<LEGEND_LOCATION>AUTOMATIC</LEGEND_LOCATION>
					<LEGEND_ALIGNMENT>LEFT</LEGEND_ALIGNMENT>
					<GRADIENT>false</GRADIENT>
					<XAXIS_LINE_WIDTH>THINNEST</XAXIS_LINE_WIDTH>
					<LEGEND>false</LEGEND>
					<Y1AXIS_SCALE_MAXIMUM>80.0</Y1AXIS_SCALE_MAXIMUM>
					<XAXIS_TITLE_ALIGNMENT>CENTER</XAXIS_TITLE_ALIGNMENT>
					<XAXIS_TICK_LABEL_ROTATE>HORIZONTAL</XAXIS_TICK_LABEL_ROTATE>
					<Y1AXIS_LOGARITHMIC_BASE>BASE_10</Y1AXIS_LOGARITHMIC_BASE>
					<TYPE>BAR_HORIZ_CLUST</TYPE>
					<GRID_WIDTH>THINNER</GRID_WIDTH>
					<PLOT_DATALABELS_BAR_POSITION>ABOVE</PLOT_DATALABELS_BAR_POSITION>
					<FOOTNOTE_ALIGNMENT>LEFT</FOOTNOTE_ALIGNMENT>
					<XAXIS_TICK_LABEL_SKIP_MODE>AUTOMATIC</XAXIS_TICK_LABEL_SKIP_MODE>
					<Y2AXIS_LOGARITHMIC_BASE>BASE_10</Y2AXIS_LOGARITHMIC_BASE>
					<GRID>true</GRID>
					<STYLE>Default</STYLE>
					<TITLE_ALIGNMENT>LEFT</TITLE_ALIGNMENT>
					<Y2AXIS_TICK_LABEL_ROTATE>HORIZONTAL</Y2AXIS_TICK_LABEL_ROTATE>
					<Y2AXIS_SCALE_MINIMUM>10.0</Y2AXIS_SCALE_MINIMUM>
					<THREED>false</THREED>
					<Y2AXIS_LINE_WIDTH>THINNEST</Y2AXIS_LINE_WIDTH>
					<Y1AXIS_TICK_LABEL_ROTATE>HORIZONTAL</Y1AXIS_TICK_LABEL_ROTATE>
					<Y2AXIS_SCALE_INCREMENT>20.0</Y2AXIS_SCALE_INCREMENT>
					<PLOT_VGRID_WIDTH>THINNER</PLOT_VGRID_WIDTH>
					<Y2AXIS_TITLE_ALIGNMENT>CENTER</Y2AXIS_TITLE_ALIGNMENT>
					<SUBTITLE_ALIGNMENT>LEFT</SUBTITLE_ALIGNMENT>
				</CustomValues>
				<query>
					<sql><![CDATA[select object_name, null col1, rds
from (
  select object_name || ' - ' || round( rds / sum(rds) OVER() * 100 ,2) || '%' object_name,  rds 
  from (
    select o.object_name, case when NVL(:lg,1) = 1 then SUM(LOGICAL_READS_DELTA)  else SUM(PHYSICAL_READS_DELTA) end as rds
    from DBA_HIST_SEG_STAT s
    join SYS.dba_objects o on o.object_id = s.obj#
    join DBA_HIST_SNAPSHOT n on n.snap_id = s.snap_id
    where n.INSTANCE_NUMBER = 2
    and n.BEGIN_INTERVAL_TIME BETWEEN to_date(:s, 'dd.mm.yyyy hh24:mi:ss') and to_date(:e, 'dd.mm.yyyy hh24:mi:ss')
    group by o.object_name
  )
  order by rds desc nulls last
)
where rownum <= :tp]]></sql>
					<binds>
						<bind id="lg">
							<prompt><![CDATA[logical=1,phys=2 reads]]></prompt>
							<tooltip><![CDATA[lg]]></tooltip>
							<value><![CDATA[2]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
						<bind id="s">
							<prompt><![CDATA[старт]]></prompt>
							<tooltip><![CDATA[s]]></tooltip>
							<value><![CDATA[17.10.2016]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
						<bind id="e">
							<prompt><![CDATA[конец]]></prompt>
							<tooltip><![CDATA[e]]></tooltip>
							<value><![CDATA[24.10.2016]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
						<bind id="tp">
							<prompt><![CDATA[top]]></prompt>
							<tooltip><![CDATA[tp]]></tooltip>
							<value><![CDATA[15]]></value>
							<bracket><![CDATA[null]]></bracket>
						</bind>
					</binds>
				</query>
					<pdf version="VERSION_1_7" compression="CONTENT">
						<docproperty title="null" author="null" subject="null" keywords="null" />
						<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
						<column>
							<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
							<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
							<blob blob="NONE" zip="false" />
						</column>
						<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
						<header enable="false" generatedate="false">
							<data>
							
							
							
							
							
							
							
							
				
				null																																																																</data>
						</header>
						<footer enable="false" generatedate="false">
							<data value="null" />
						</footer>
						<security enable="false" useopenpassword="false" openpassword="null" encryption="EXCLUDE_METADATA">
							<permission enable="false" permissionpassword="null" allowcopying="true" allowprinting="true" allowupdating="false" allowaccessdevices="false" />
						</security>
						<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
					</pdf>
			</display>
		</folder>
	</folder>
</folder>
</displays>